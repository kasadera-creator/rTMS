{% load static %}
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>印刷プレビュー（合本）</title>
    <link rel="stylesheet" href="{% static 'rtms_app/print.css' %}">
</head>
<body>
    <div class="print-header screen-only">
        <div>
            <strong>印刷プレビュー（合本）</strong>
            <span class="ms-2">患者: {{ patient.name }} (ID: {{ patient.card_id }})</span>
        </div>
        <div class="print-actions">
            <button class="btn btn-light btn-sm" onclick="window.print()">印刷</button>
            <a class="btn btn-outline-light btn-sm" href="{% url 'patient_first_visit' patient.id %}">初診画面へ戻る</a>
        </div>
    </div>

    <div class="bundle-container">
        <div class="screen-only mb-3">
            <div class="fw-bold">選択中の文書</div>
            <div>
                {% for doc in selected_docs %}
                    {% if doc == 'admission' %}<span class="badge bg-primary me-1">入院時サマリ</span>{% endif %}
                    {% if doc == 'suitability' %}<span class="badge bg-success me-1">rTMS適正質問票</span>{% endif %}
                    {% if doc == 'consent' %}<span class="badge bg-info text-dark me-1">rTMS治療説明書・同意書</span>{% endif %}
                {% endfor %}
            </div>
        </div>

        <div class="bundle-section">
            {% for doc in selected_docs %}
                <div class="doc-wrapper{% if not forloop.first %} page-break{% endif %}">
                    {% if doc == 'admission' %}
                        {% include "rtms_app/print/admission_summary.html" %}
                    {% elif doc == 'suitability' %}
                        {% include "rtms_app/print/suitability_questionnaire.html" %}
                    {% elif doc == 'consent' %}
                        {% include "rtms_app/print/rtms_consent.html" %}
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    </div>
</body>
</html>
